{"version":3,"sources":["assets\\src\\Network\\API.js"],"names":["cc","Class","Component","properties","betScene","type","Node","errorLayer","errorLabel","Label","backHome","onLoad","start","startGuestMode","active","global","isDemo","getComponent","updateCreditLabel","getSettings","host_id","getParameterByName","access_token","xhr","XMLHttpRequest","self","string","onreadystatechange","readyState","status","response","responseText","parsed","JSON","parse","settings","data","scheduleOnce","body","json","stringify","apiURL","api_url","undefined","isProduction","url","open","setRequestHeader","send","error","message","DemoSettings","isPlayerBalanceUpdated","name","window","location","href","replace","regex","RegExp","results","exec","decodeURIComponent"],"mappings":"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","sourceRoot":"/","sourcesContent":["import * as global from \"GlobalData\";\r\nimport * as constant from \"Constant\";\r\nimport * as ecrypt from \"Encrypt\";\r\n\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        // foo: {\r\n        //    default: null,      // The default value will be used only when the component attaching\r\n        //                           to a node for the first time\r\n        //    url: cc.Texture2D,  // optional, default is typeof default\r\n        //    serializable: true, // optional, default is true\r\n        //    visible: true,      // optional, default is true\r\n        //    displayName: 'Foo', // optional\r\n        //    readonly: false,    // optional, default is false\r\n        // },\r\n\t\t// ...\r\n\t\t\r\n\t\tbetScene:{\r\n\t\t\tdefault:null,\r\n\t\t\ttype:cc.Node,\r\n\t\t},\r\n\r\n\t\terrorLayer:{\r\n\t\t\tdefault:null,\r\n\t\t\ttype:cc.Node,\r\n\t\t},\r\n\t\t\r\n\t\terrorLabel:{\r\n\t\t\tdefault:null,\r\n\t\t\ttype:cc.Label,\r\n\t\t},\r\n\r\n\t\tbackHome:{\r\n\t\t\tdefault:null,\r\n\t\t\ttype:cc.Node,\t\r\n\t\t},\r\n    },\r\n\r\n    // use this for initialization\r\n    onLoad: function () {\r\n    },\r\n\r\n    start(){\r\n        // this.connectAPI();\r\n    },\r\n\tstartGuestMode() {\r\n\t\tthis.errorLayer.active=false;\r\n\t\tglobal.isDemo = true;\r\n\t\tthis.betScene.getComponent(\"StartScene\").updateCreditLabel();\r\n\t},\r\n    getSettings(){\r\n\t\tglobal.host_id = this.getParameterByName('host_id');\r\n\t\tglobal.access_token = this.getParameterByName('access_token');\r\n\t\tlet xhr = new XMLHttpRequest();\r\n\t\tvar self = this;\r\n\r\n\t\tif(global.host_id==null && global.access_token==null){\r\n\t\t\tif(!global.isDemo){\r\n\t\t\t\tself.errorLayer.active = true;\r\n\t\t\t\tself.errorLabel.string=\" You Are Playing For Fun.\";\r\n\t\t\t\txhr.onreadystatechange = function(){\r\n\t\t\t\t\tif(xhr.readyState == 4 &&(xhr.status >= 200 && xhr.status < 400)) {\r\n\t\t\t\t\t\tvar response = xhr.responseText;\r\n\t\t\t\t\t\tvar parsed = JSON.parse(response);\r\n\t\t\r\n\t\t\t\t\t\tglobal.settings = parsed.data;\r\n\t\t\t\t\t\r\n\t\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\t};\r\n\t\t\t}\r\n\t\t\telse{\r\n\t\t\t\tself.scheduleOnce(function(){\r\n\t\t\t\t\tself.betScene.getComponent(\"StartScene\").updateCreditLabel();\r\n\t\t\t\t\t\r\n\t\t\t\t},0.2);\r\n\t\t\t}\r\n\t\t\r\n\r\n\t\t\tvar body = {\r\n\t\t\t\t\"device_type\": \"Desktop\",\r\n\t\t\t\t\"game_code\": 23,\r\n\t\t\t\t\"country_code\": \"MY\"\r\n\t\t\t}\r\n\t\r\n\t\t\t\r\n\t\t\tvar json = JSON.stringify(body);\r\n\t\t\tvar apiURL= global.api_url;\r\n\t\t\tif (global.api_url == undefined) {\r\n\t\t\t\tapiURL = \"https://bo-stage.slot28.com\";\r\n\t\t\t\tif (global.isProduction) {\r\n\t\t\t\t\tapiURL = \"https://bo.slot28.com\";\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tlet url = apiURL+\"/api/user/get-settings-demo\";\r\n\t\t\r\n\t\t\t// let url = \"https://bo-stage-apl.velachip.com/api/user/get-settings?host_id=0e83088027d4c42c8e9934388480c996&access_token=demo01&game_code=21\";\r\n\t\t\txhr.open(\"POST\", url, true);\r\n\t\t\txhr.setRequestHeader(\"Content-Type\", \"application/json\");\r\n\t\t\txhr.setRequestHeader(\"Accept-Language\", \"en-US\");\r\n\t\t\txhr.send(json);\r\n\t\t}\r\n\r\n\t\telse{\r\n\t\t\txhr.onreadystatechange = function(){\r\n\t\t\t\tif(xhr.readyState == 4 &&(xhr.status >= 200 && xhr.status < 400)) {\r\n\t\t\t\t\tvar response = xhr.responseText;\r\n\t\t\t\t\tvar parsed = JSON.parse(response);\r\n\t\r\n\t\t\t\t\tglobal.settings = parsed.data;\r\n\t\t\t\t\t// global.setSettings(parsed.data);\r\n\t\r\n\t\t\t\t\t\r\n\t\t\t\t\t//global.balance = global.settings.balance;\r\n\t\r\n\t\t\t\t\tif(global.settings==undefined){\r\n\t\t\t\t\t\tself.errorLayer.active = true;\r\n\t\t\t\t\t\tself.errorLabel.string = parsed.error.message;\r\n\t\t\t\t\t\tglobal.settings=global.DemoSettings;\r\n\t\t\t\t\t\tself.backHome.active=true;\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse{\r\n\t\t\t\t\t\tglobal.isPlayerBalanceUpdated = true;\r\n\t\t\t\t\t\tself.betScene.getComponent(\"StartScene\").updateCreditLabel();\r\n\t\r\n\t\t\t\t\t}\r\n\t\t\t\t\t// console.log(global.getSettings());\r\n\t\t\t\t}\r\n\t\t\t\telse{\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\r\n\t\t\tvar body = {\r\n\t\t\t\t\"host_id\": this.getParameterByName('host_id'), \r\n\t\t\t\t\"access_token\": this.getParameterByName('access_token'),\r\n\t\t\t\t\"device_type\": \"Desktop\",\r\n\t\t\t\t\"game_code\": 23,\r\n\t\t\t\t\"country_code\": \"MY\"\r\n\t\t\t}\r\n\t\r\n\t\t\tvar json = JSON.stringify(body);\r\n\t\t\tvar apiURL = global.api_url;\r\n\t\t\tif (global.api_url == undefined) {\r\n\t\t\t\tapiURL = \"https://bo-stage.slot28.com\";\r\n\t\t\t\tif (global.isProduction) {\r\n\t\t\t\t\tapiURL = \"https://bo.slot28.com\";\r\n\t\t\t\t}\r\n\t\t\t\tglobal.api_url=apiURL;\r\n\t\t\t}\r\n\r\n\t\t\tlet url = apiURL + \"/api/user/get-settings?host_id=\"+global.host_id+\"&access_token=\"+global.access_token+\"&game_code=23\";\r\n\t\t\t// let url = \"https://bo.slot28.com/api/user/get-settings?host_id=\"+global.host_id+\"&access_token=\"+global.access_token+\"&game_code=23\";\r\n\t\r\n\t\t\t// let url = \"https://bo-stage-apl.velachip.com/api/user/get-settings?host_id=0e83088027d4c42c8e9934388480c996&access_token=demo06&game_code=23\";\r\n\t\t\txhr.open(\"POST\", url, true);\r\n\t\t\txhr.setRequestHeader(\"Content-Type\", \"application/json\");\r\n\t\t\txhr.setRequestHeader(\"Accept-Language\", \"en-US\");\r\n\t\t\txhr.send(json);\r\n\t\t}\r\n\t\t\r\n\t},\r\n\tgetParameterByName(name, url) {\r\n\t\tif (!url) url = window.location.href;\r\n\t\tname = name.replace(/[\\[\\]]/g, \"\\\\$&\");\r\n\t\tvar regex = new RegExp(\"[?&]\" + name + \"(=([^&#]*)|&|#|$)\"),\r\n\t\t\tresults = regex.exec(url);\r\n\t\tif (!results) return null;\r\n\t\tif (!results[2]) return '';\r\n\r\n\t\t\treturn decodeURIComponent(results[2].replace(/\\+/g, \" \"));\r\n\t},\r\n    // called every frame, uncomment this function to activate update callback\r\n    // update: function (dt) {\r\n\r\n    // },\r\n});\r\n"]}